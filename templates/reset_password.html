<!DOCTYPE html>
<html lang="en">
  <head>
    <title>SMP Challenge</title>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
    <link rel="stylesheet" href="/static/css/bootstrap.css">
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.js"></script>
    <script src="/static/js/sprintf.js"></script>
    <script src="/static/js/md5.js"></script>
    <style type="text/css">
      #nav-first {
        border-radius: 0px;
        margin-bottom: 0px;
        min-height: 80px;
      }

      #nav-second {
        border-radius: 0px;
        margin-bottom: 0px;
        top: 80px;
      }

      #nav-first-main {
        margin: 0 0;
        height: 80px;
      }

      #nav-first-main>li {
        height: 80px;
      }
      #nav-first-main>li>a {
        height: 80px;
        padding-top: 0;
        padding-bottom: 0;
        line-height: 80px;
      }

      #nav-second-main {
        margin: 0 80px;
      }

      .nav-second-li {
        font-size: 120%;
      }

      #container {
        padding-top: 150px;
      }

      #block7 {
        background-color: #080808;
        position: absolute;
        bottom: 0;
        width: 100%;
      }

      .help-block {
        display: none;
      }

    </style>
    <script type="text/javascript">
      $(document).ready(function(){
        $("input").focus(function(){
          $(".form-group").removeClass("has-error");
          $(".help-block").hide();
        });

        $("#reset").click(function(){
          var password = $("#password").val();
          var repeat_password = $("#repeat-password").val();

          var flag = true;
          if (password == "") {
            $("#password").parent().addClass("has-error");
            $("#password-warn").text("password can not be empty").show();
            flag = false;
          }

          if (repeat_password == "") {
            $("#repeat-password").parent().addClass("has-error");
            $("#repeat-password-warn").text("repeat-password can not be empty").show();
            flag = false;
          }

          if (password.length > 0 && password.length < 8) {
            $("#password").parent().addClass("has-error");
            $("#password-warn").text("password too short").show();
            flag = false;
          }

          if (repeat_password.length > 0 && password != repeat_password) {
            $("#repeat-password").parent().addClass("has-error");
            $("#repeat-password-warn").text("Two input password must be consistent").show();
            flag = false;
          }

          if (flag == false) {
            return;
          }
          password = md5(password);
          var data = {
            "password": password
          }
          $.post("/reset_password/{{token}}", data, function(data, status) {
            if (data.code == "00000") {
              alert("reset successfully");
              window.location.href = "/";
            }
          });

        });
      });
    </script>
  </head>
  <body>

    <nav class="navbar navbar-inverse navbar-fixed-top" id="nav-second">
      <div class="container">
        <ul class="nav navbar-nav" id="nav-second-main">
          <li class="nav-li"><a class="nav-second-li" href="#" id="href-home"><b>Home</b></a></li>
          <li class="nav-li"><a class="nav-second-li" href="/dataset" id="href-description"><b>Dataset</b></a></li>
          <li class="nav-li"><a class="nav-second-li" href="/download" id="href-dataset"><b>Download</b></a></li>
          <li class="nav-li"><a class="nav-second-li" href="/challenge" id="href-challenge"><b>Challenge</b></a></li>
          <li class="nav-li"><a class="nav-second-li" href="/leaderboard" id="href-leaderboard"><b>Leaderboard</b></a></li>
        </ul>
      </div>
    </nav>

    <nav class="navbar navbar-default navbar-fixed-top" id="nav-first">
      <div class="container">
        <div class="navbar-header">
          <img src="/static/img/logo.png" width="400px" id="logo">
        </div>
        <ul class="nav navbar-nav navbar-right" id="nav-first-main">
          <li class="nav-li"><a href="mailto:social.media.prediction@gmail.com" id="href-contact"><span class="glyphicon glyphicon-envelope" aria-hidden="true"></span> Contact</a></li>
        </ul>
      </div>
    </nav>

    <div class="container-fluid" id="container">
      <div class="row">
        <div class="col-md-6 col-md-offset-3">
          <div class="panel panel-default">
            {% if not expire %}
            <div class="panel-heading">
              <h4>Reset Password</h4>
            </div>
            {% endif %}
            <div class="panel-body">
              {% if expire %}
              <center><h4>invalid url</h4></center>
              {% else %}
              <form>
                <div class="form-group">
                  <label for="email">Email</label>
                  <input type="email" class="form-control" id="email" disabled="disabled" value="{{email}}">
                </div>
                <div class="form-group">
                  <label for="password">Password</label>
                  <input type="password" class="form-control" id="password">
                  <span id="password-warn" class="help-block"></span>
                </div>
                <div class="form-group">
                  <label for="repeat-password">Repeat Password</label>
                  <input type="password" class="form-control" id="repeat-password">
                  <span id="repeat-password-warn" class="help-block"></span>
                </div>
              </form>
              <center><button class="btn btn-primary" id="reset">Reset</button></center>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
      <div class="row" id="block7">
        <div class="col-md-10 col-md-offset-1">
          <center><h5 style="color:white;">Copyright Â© 2019. SMP Challenge Organization Committee. All rights reserved.</h5></center>
        </div>
      </div>
    </div>


  </body>
 </html>
